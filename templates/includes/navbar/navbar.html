{% load i18n %}
{% get_current_language as LANGUAGE_CODE %}

<nav class="navbar navbar-light border-bottom w-100">
  <div class="container-fluid px-3">

    <!-- ROW 1 -->
    <div class="row align-items-center g-2 py-2 w-100">

      <!-- Brand -->
      <div class="col-6 col-lg-3">
        <a class="navbar-brand d-flex align-items-center gap-2 m-0" href="{% url 'home:index' %}">
          <img src="/media/flomarkt24-logo-bg.png" alt="" class="logo-light border-radios-50" width="50" height="50" />
          <h1 class="fw-semibold m-0 brand-title"><strong>{% trans 'Flomarkt24' %}</strong></h1>
        </a>
      </div>

      <!-- Search (desktop center) -->
      <div class="d-none d-lg-flex col-lg-6 justify-content-center">
        {% include "includes/navbar/search.html" %}
      </div>

      <!-- Desktop utilities (right): Lang | Account | Cart -->
      <div class="d-none d-lg-flex col-lg-3 justify-content-end align-items-center gap-3">
        {% include "includes/navbar/lang.html" %}
        {% include "includes/navbar/account.html" %}
        <a class="nav-link{% if grand_total %} text-info fw-bold{% endif %}" href="#">
          <i class="bi bi-bag"></i>
          {% if grand_total %}${{ grand_total|floatformat:2 }}{% else %}$0.00{% endif %}
        </a>
      </div>

      <!-- Mobile cart (right) -->
      <div class="col-6 d-lg-none text-end">
        <a class="nav-link{% if grand_total %} text-info fw-bold{% endif %}" href="#">
          <i class="bi bi-bag"></i>
          {% if grand_total %}${{ grand_total|floatformat:2 }}{% else %}$0.00{% endif %}
        </a>
      </div>
    </div>

    <!-- ROW 1B: Mobile search -->
    <div class="row d-lg-none py-1 w-100">
      <div class="col-12">
        {% include "includes/navbar/search.html" %}
      </div>
    </div>

    <!-- ROW 2 (mobile: burger LEFT, account CENTER, language RIGHT) -->
    <div class="row align-items-center py-1 g-2 w-100">

      <!-- Mobile: Burger (left) -->
      <div class="col-4 d-lg-none text-start">
        <button class="navbar-toggler" type="button"
                data-bs-toggle="collapse" data-bs-target="#primaryNav"
                aria-controls="primaryNav" aria-expanded="false"
                aria-label="{% trans 'Toggle navigation' %}">
          <span class="navbar-toggler-icon"></span>
        </button>
      </div>

      <!-- Mobile: Account (center) -->
      <div class="col-4 d-lg-none text-center">
        <div class="d-inline-block">
          {% include "includes/navbar/account.html" %}
        </div>
      </div>

      <!-- Mobile: Language (right) -->
      <div class="col-4 d-lg-none text-end">
        {% include "includes/navbar/lang.html" %}
      </div>

      <!-- Desktop: Primary links (left) + spacer -->
      <div class="col-12 col-lg-6 d-none d-lg-block">
        <div id="primaryNav" class="collapse d-lg-block">
          {% include "includes/navbar/links.html" %}
        </div>
      </div>
      <div class="d-none d-lg-block col-lg-6"></div>

      <!-- Mobile: Collapsed primary links full width -->
      <div class="col-12 d-lg-none">
        <div id="primaryNav" class="collapse">
          <div class="py-1">
            {% include "includes/navbar/links.html" %}
          </div>
        </div>
      </div>

    </div>

  </div>
</nav>
